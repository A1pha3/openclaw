---
summary: "macOS 应用中的语音唤醒与按键通话功能详解"
read_when:
  - 处理语音唤醒或 PTT 路径
  - 配置唤醒词识别与麦克风
  - 调试语音识别准确率
  - 理解 VoiceWakeRuntime 生命周期
title: "语音唤醒与按键通话"
---

# 语音唤醒与按键通话配置指南

本章节深入解析 OpenClaw macOS 应用中的语音唤醒系统，涵盖唤醒词模式、按键通话（Push-to-Talk）模式、语音识别运行时管理、生命周期不变量与故障加固机制。通过学习本章节，你将掌握语音唤醒的完整技术栈，能够配置麦克风与语言选项、优化唤醒词识别准确率，并独立完成语音识别相关问题的故障排查。

## 学习目标

完成本章节学习后，你将能够：

### 基础目标（必掌握）

- [ ] 理解 **语音唤醒**与 **按键通话**两种交互模式的区别与适用场景
- [ ] 掌握麦克风选择、语言设置与唤醒词配置
- [ ] 理解语音识别运行时的基本生命周期
- [ ] 执行基本的唤醒准确率测试

### 进阶目标（建议掌握）

- [ ] 深入理解 **VoiceWakeRuntime** 的状态机与事件处理
- [ ] 优化唤醒词识别准确率（环境噪音、麦克风位置）
- [ ] 配置触发词敏感度与静音超时
- [ ] 调试语音识别异常（误触发、漏识别）

### 专家目标（挑战）

- [ ] 自定义唤醒词（修改识别模型）
- [ ] 扩展语音识别支持（多语言、自定义 ASR）
- [ ] 构建语音唤醒性能监控体系
- [ ] 设计高可用语音识别降级策略

---

## 第一部分：交互模式概述

### 两种交互模式对比

OpenClaw macOS 应用支持两种语音交互模式：

| 维度 | 唤醒词模式 | 按键通话模式 |
|------|-----------|-------------|
| **触发方式** | 说出唤醒词（如 "Hey OpenClaw"） | 按住右 Option 键 |
| **适用场景** | 免提操作、持续监听 | 精确控制、嘈杂环境 |
| **响应速度** | 唤醒后立即开始监听 | 即时响应 |
| **功耗** | 持续监听（较高） | 仅按键时工作 |
| **误触发风险** | 有（需优化唤醒词） | 无 |

**唤醒词模式详解**：

```
┌─────────────────────────────────────────────────────────────┐
│                  唤醒词模式工作流程                           │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   ┌─────────────────────────────────────────────────────┐   │
│   │              VoiceWakeRuntime (持续运行)              │   │
│   │                                                      │   │
│   │   ┌─────────────┐    ┌─────────────┐               │   │
│   │   │  音频输入    │───→│  VAD 检测   │               │   │
│   │   │  (麦克风)    │    │  (静音区分) │               │   │
│   │   └─────────────┘    └──────┬──────┘               │   │
│   │                             │                        │   │
│   │                             ▼                        │   │
│   │                    ┌─────────────────┐               │   │
│   │                    │  唤醒词识别     │               │   │
│   │                    │  (本地 ASR)     │               │   │
│   │                    └────────┬────────┘               │   │
│   │                             │                        │   │
│   │         ┌───────────────────┼───────────────────┐   │   │
│   │         ▼                   ▼                       ▼   │   │
│   │   ┌──────────┐      ┌──────────┐      ┌──────────┐│   │
│   │   │ 触发成功  │      │ 未触发    │      │ 超时     ││   │
│   │   │ (唤醒)   │      │ (继续监听)│      │ (复位)   ││   │
│   │   └────┬─────┘      └──────────┘      └──────────┘│   │
│   │        │                                              │   │
│   │        ▼                                              │   │
│   │   ┌──────────────────────────────────────────┐       │   │
│   │   │           语音输入捕获模式                 │       │   │
│   │   │   - 显示浮层                            │       │   │
│   │   │   - 流式转写文本                       │       │   │
│   │   │   - 检测静音结束                       │       │   │
│   │   └─────────────────────┬──────────────────┘       │   │
│   │                         │                            │   │
│   │                         ▼                            │   │
│   │                  ┌─────────────────┐                │   │
│   │                  │  发送文本       │                │   │
│   │                  │  助手处理       │                │   │
│   │                  └────────┬────────┘                │   │
│   │                         │                            │   │
│   │                         ▼                            │   │
│   │                  ┌─────────────────┐                │   │
│   │                  │  复位到监听模式  │                │   │
│   │                  │  (等待唤醒词)    │                │   │
│   │                  └─────────────────┘                │   │
│   │                                                      │   │
│   └──────────────────────────────────────────────────────┘   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**按键通话模式详解**：

```
┌─────────────────────────────────────────────────────────────┐
│                  按键通话模式工作流程                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   ┌─────────────────────────────────────────────────────┐   │
│   │              等待按键触发状态                         │   │
│   │                                                      │   │
│   │   ┌─────────────────────────────────────────────┐   │   │
│   │   │         监听右 Option 键按下                   │   │   │
│   │   │         (keyCode 61 + .option)                │   │   │
│   │   └─────────────────────┬───────────────────────┘   │   │
│   │                         │                            │   │
│   │           ┌─────────────┴─────────────┐             │   │
│   │           ▼                           ▼             │   │
│   │   ┌─────────────────┐         ┌─────────────────┐    │   │
│   │   │  右 Option 按下  │         │  其他按键       │    │   │
│   │   │  (触发捕获)     │         │  (忽略)         │    │   │
│   │   └────────┬────────┘         └─────────────────┘    │   │
│   │            │                                           │   │
│   │            ▼                                           │   │
│   │   ┌─────────────────────────────────────────────┐    │   │
│   │   │           语音输入捕获模式                     │    │   │
│   │   │   - 暂停唤醒词监听                           │    │   │
│   │   │   - 显示浮层（实时转写）                      │    │   │
│   │   │   - 捕获音频直到按键释放                      │    │   │
│   │   └─────────────────────┬───────────────────────┘    │   │
│   │                         │                              │   │
│   │           ┌─────────────┴─────────────┐                │   │
│   │           ▼                           ▼                │   │
│   │   ┌─────────────────┐         ┌─────────────────┐     │   │
│   │   │  按键释放       │         │  超时（120s）    │     │   │
│   │   │  (结束捕获)     │         │  (强制结束)      │     │   │
│   │   └────────┬────────┘         └─────────────────┘     │   │
│   │            │                                            │   │
│   │            ▼                                            │   │
│   │   ┌─────────────────────────────────────────────┐    │   │
│   │   │           延迟确认模式                        │    │   │
│   │   │   - 显示已捕获文本                          │    │   │
│   │   │   - 用户可编辑/确认                         │    │   │
│   │   │   - 超时后发送                              │    │   │
│   │   └─────────────────────┬───────────────────────┘    │   │
│   │                         │                              │   │
│   │                         ▼                              │   │
│   │                  ┌─────────────────┐                  │   │
│   │                  │  发送文本       │                  │   │
│   │                  │  助手处理       │                  │   │
│   │                  └────────┬────────┘                  │   │
│   │                         │                              │   │
│   │                         ▼                              │   │
│   │                  ┌─────────────────┐                  │   │
│   │                  │  恢复按键监听   │                  │   │
│   │                  └─────────────────┘                  │   │
│   │                                                      │   │
│   └──────────────────────────────────────────────────────┘   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 唤醒词模式详解

**默认唤醒词**：`swabble` 或其他配置的触发词

**唤醒条件**：

| 条件 | 说明 | 配置 |
|------|------|------|
| **唤醒词检测** | 音频流中识别到唤醒词 | 语音模型 |
| **有意义的停顿** | 唤醒词与后续文本之间约 0.55 秒停顿 | 系统内置 |
| **麦克风权限** | 已授予麦克风与语音识别权限 | 用户配置 |

**状态转换**：

```
监听状态 ──唤醒词检测成功──→ 捕获状态 ──检测到停顿──→ 发送状态
    │                              │                      │
    │                              │                      ▼
    │                              │              助手处理状态
    │                              │                      │
    │                              │                      ▼
    │                              │              复位到监听状态
    │                              │
    │                              ▼
    └─────────────────── 超时（2s 无语音）───→ 复位到监听状态
```

### 按键通话模式详解

**热键**：右 Option 键（`keyCode 61` + `.option`）

**按键行为**：

| 事件 | 响应 |
|------|------|
| 右 Option 键按下 | 开始语音捕获 |
| 右 Option 键释放 | 结束捕获，进入延迟确认 |
| 延迟超时（可配置） | 自动发送 |

**特性**：

- 无需唤醒词，直接开始监听
- 捕获期间显示实时转写浮层
- 松开后可短暂编辑确认文本
- 自动恢复唤醒词监听

---

## 第二部分：运行时行为详解

### VoiceWakeRuntime 架构

**核心组件**：

```
┌─────────────────────────────────────────────────────────────┐
│                  VoiceWakeRuntime 组件结构                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   ┌─────────────────────────────────────────────────────┐   │
│   │              VoiceWakeRuntime                        │   │
│   │                                                      │   │
│   │   ┌─────────────────────────────────────────────┐   │   │
│   │   │           AudioCaptureEngine                 │   │   │
│   │   │   ├── 麦克风设备管理                         │   │   │
│   │   │   ├── 音频流缓冲                            │   │   │
│   │   │   └── 采样率/格式转换                       │   │   │
│   │   └─────────────────────────────────────────────┘   │   │
│   │                                                      │   │
│   │   ┌─────────────────────────────────────────────┐   │   │
│   │   │           VoiceActivityDetector              │   │   │
│   │   │   ├── VAD（语音活动检测）                   │   │   │
│   │   │   ├── 唤醒词触发                           │   │   │
│   │   │   └── 静音超时检测                         │   │   │
│   │   └─────────────────────────────────────────────┘   │   │
│   │                                                      │   │
│   │   ┌─────────────────────────────────────────────┐   │   │
│   │   │           SpeechRecognizer                   │   │   │
│   │   │   ├── 本地 ASR（离线识别）                  │   │   │
│   │   │   ├── 文本规范化                            │   │   │
│   │   │   └── 置信度评分                           │   │   │
│   │   └─────────────────────────────────────────────┘   │   │
│   │                                                      │   │
│   │   ┌─────────────────────────────────────────────┐   │   │
│   │   │           VoiceWakeOverlayController         │   │   │
│   │   │   ├── 浮层 UI 渲染                          │   │   │
│   │   │   ├── 实时转写显示                          │   │   │
│   │   │   └── 提交状态动画                          │   │   │
│   │   └─────────────────────────────────────────────┘   │   │
│   │                                                      │   │
│   └──────────────────────────────────────────────────────┘   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 关键时序参数

| 参数 | 默认值 | 说明 | 调整影响 |
|------|--------|------|----------|
| **唤醒词后停顿** | ~0.55s | 唤醒词与命令之间的最小间隔 | 太小：误触发；太大：响应延迟 |
| **静音超时（语音中）** | 2.0s | 检测到语音后等待静音的最长时间 | 太短：打断说话；太长：等待久 |
| **静音超时（仅唤醒词）** | 5.0s | 仅检测到唤醒词时的超时 | 太短：来不及说话；太长：响应慢 |
| **硬停止超时** | 120s | 整个语音会话的最长时间 | 防止资源无限占用 |
| **会话去抖间隔** | 350ms | 两次发送之间的最小间隔 | 防止重复发送 |

### 浮层行为

**VoiceWakeOverlayController** 管理语音交互的视觉反馈：

| 状态 | 浮层表现 |
|------|---------|
| **监听中** | 显示"正在聆听..."或隐藏 |
| **检测到唤醒词** | 短暂高亮，显示唤醒词 |
| **语音捕获中** | 实时转写文本，麦克风波形 |
| **已提交** | 绿色勾选，发送中动画 |
| **错误** | 红色 X，显示错误信息 |

---

## 第三部分：生命周期不变量

### 核心不变量

VoiceWakeRuntime 维护以下关键不变量：

```
┌─────────────────────────────────────────────────────────────┐
│                  生命周期不变量                               │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  不变量 1：唤醒词监听始终可用                                 │
│  ─────────────────────────────────────────────────────────  │
│  如果启用了语音唤醒且权限已授予，                              │
│  唤醒词识别器应该始终在监听，                                  │
│  除非正在进行显式的按键通话捕获。                              │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  正常流程：                                           │  │
│  │  监听 → 唤醒词 → 捕获 → 发送 → 监听                  │  │
│  │         ↑                                    │        │  │
│  │         └────────────────────────────────────┘        │  │
│  │  正确：捕获完成后自动恢复到监听状态                     │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  不变量 2：浮层关闭不应阻止监听恢复                           │
│  ─────────────────────────────────────────────────────────  │
│  浮层可见性（包括通过 X 按钮手动关闭）                         │
│  绝不能阻止识别器恢复监听状态。                               │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  错误场景（旧版本问题）：                              │  │
│  │  用户关闭浮层 → 监听器无法恢复 → 用户以为语音唤醒"死了"│  │
│  │                                                          │  │
│  │  正确行为：                                             │  │
│  │  用户关闭浮层 → VoiceSessionCoordinator 触发刷新        │  │
│  │           → VoiceWakeRuntime.refresh()                 │  │
│  │           → 监听自动恢复                              │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 粘滞浮层问题与加固

**历史问题**：

```
粘滞浮层故障模式（旧版本）：

┌─────────────────────────────────────────────────────────────┐
│                                                              │
│   1. 语音唤醒触发，浮层显示                                   │
│          │                                                  │
│          ▼                                                  │
│   2. 用户关闭浮层（点击 X）                                   │
│          │                                                  │
│          ▼                                                  │
│   3. 浮层关闭，但 VoiceWakeRuntime 未收到通知                 │
│          │                                                  │
│          ▼                                                  │
│   4. Runtime 等待浮层关闭事件                                 │
│          │                                                  │
│          ▼                                                  │
│   5. Runtime 认为浮层仍可见，阻止重启                         │
│          │                                                  │
│          ▼                                                  │
│   6. 用户再次尝试唤醒词 → 无响应                              │
│          │                                                  │
│          ▼                                                  │
│   7. 用户认为"语音唤醒坏了" → 重启应用                       │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**加固措施**：

```swift
// 解决方案：浮层关闭触发 Runtime 刷新

// VoiceWakeOverlayController.swift
func onOverlayClosed() {
    // 通过 Coordinator 通知 Runtime
    coordinator.notifyOverlayClosed()
}

// VoiceSessionCoordinator.swift
func notifyOverlayClosed() {
    // 触发 Runtime 刷新
    voiceWakeRuntime.refresh()
}

// VoiceWakeRuntime.swift
func refresh() {
    // 无论浮层当前状态如何，都刷新监听器
    restartListening()
    clearState()
}
```

---

## 第四部分：用户配置选项

### 设置界面选项

macOS 应用提供以下语音唤醒配置：

**基础开关**：

| 选项 | 功能 |
|------|------|
| **语音唤醒** | 启用/禁用唤醒词监听 |
| **按住 Cmd+Fn 说话** | 启用/禁用按键通话模式（在 macOS < 26 上禁用） |

**详细配置**：

| 选项 | 功能 | 默认值 |
|------|------|--------|
| **语言** | 语音识别语言 | 系统首选语言 |
| **麦克风** | 输入设备选择 | 系统默认麦克风 |
| **触发词** | 自定义唤醒词 | 默认唤醒词 |
| **触发词敏感度** | 唤醒词检测阈值 | 中等 |
| **提示音** | 触发/发送时的声音反馈 | macOS Glass |

### 麦克风选择器行为

**设备断开处理**：

```
┌─────────────────────────────────────────────────────────────┐
│                  麦克风选择器行为                              │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   场景：用户选择特定麦克风后设备断开                           │
│                                                              │
│   处理流程：                                                 │
│   ┌─────────────────────────────────────────────────────┐  │
│   │  1. 检测到设备断开                                   │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  2. 显示断开提示                                     │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  3. 临时回退到系统默认麦克风                          │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  4. 设备重新连接后恢复用户选择                         │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  5. 通知用户已恢复                                   │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 实时电平表

**功能**：显示麦克风输入的实时音量

```
┌─────────────────────────────────────────────────────────────┐
│                  电平表显示示例                               │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   ┌─────────────────────────────────────────────┐          │
│   │  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░░░░░░░░░░░░░░░  │          │
│   │  ↑                    ↑                       │          │
│   │  静音阈值           当前音量                  │          │
│   │                                            │          │
│   │  正常语音：                                 │          │
│   │  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░░░░░░░░░░░░░    │          │
│   │                                              │          │
│   │  静音状态：                                 │          │
│   │  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │          │
│   │                                              │          │
│   │  过高音量（可能失真）：                       │          │
│   │  ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓  │          │
│   └─────────────────────────────────────────────┘          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 提示音配置

**触发场景**：

| 事件 | 提示音 |
|------|--------|
| **唤醒词检测** | 检测到唤醒词时播放 |
| **发送完成** | 文本发送给助手时播放 |

**可用声音**：

```bash
# 系统内置声音示例
Glass      # 默认，清晰的短音
Basso      # 低沉的提示音
Funk       # 较长的旋律
Hero       # 成就/完成音效
```

---

## 第五部分：转发行为详解

### 转发目标选择

语音唤醒的转录文本默认发送到**上次使用的主要提供商**：

```
┌─────────────────────────────────────────────────────────────┐
│                  转发目标优先级                               │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   1. 最近活跃的消息渠道                                       │
│      ├── WhatsApp（如果有未读消息）                          │
│      ├── Telegram（如果有未读消息）                          │
│      └── ...                                                │
│                                                              │
│   2. WebChat（当前会话）                                     │
│                                                              │
│   3. 命令输出（无有效渠道）                                   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**优先级规则**：

| 优先级 | 渠道 | 条件 |
|--------|------|------|
| 1 | WhatsApp | 最近活跃且可用 |
| 2 | Telegram | 最近活跃且可用 |
| 3 | Discord | 最近活跃且可用 |
| 4 | WebChat | 总是可用 |
| 5 | CLI 输出 | 回退选项 |

### 错误处理

```
┌─────────────────────────────────────────────────────────────┐
│                  发送错误处理                                 │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   场景：语音文本发送失败                                      │
│                                                              │
│   处理流程：                                                 │
│   ┌─────────────────────────────────────────────────────┐  │
│   │  1. 发送失败                                         │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  2. 记录错误日志                                     │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  3. 通知用户（可选）                                 │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  4. 保持语音唤醒可用                                 │  │
│   │           │                                          │  │
│   │           ▼                                          │  │
│   │  5. 用户仍可通过 WebChat/会话日志查看转录              │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 转发负载结构

```json
{
  "type": "voice_transcript",
  "data": {
    "transcript": "Hello, what's the weather today?",
    "mode": "wakeword",  // 或 "ptt"
    "timestamp": "2026-02-05T14:30:00Z",
    "confidence": 0.95,
    "language": "en-US",
    "duration_ms": 3500
  },
  "metadata": {
    "source": "macos_voice_wake",
    "client_id": "bot.molt.mac"
  }
}
```

---

## 第六部分：快速验证与测试

### 唤醒词模式测试

**测试步骤**：

```
验证唤醒词功能：

┌─────────────────────────────────────────────────────────────┐
│  1. 确保配置正确                                             │
│     ├── 语音唤醒开关：开启                                   │
│     ├── 麦克风权限：已授予                                   │
│     ├── 唤醒词：已配置                                       │
│     └── 麦克风：已选择                                       │
│                                                              │
│  2. 执行测试                                                 │
│     ├── 说出唤醒词                                           │
│     ├── 等待检测提示音                                       │
│     ├── 说出命令                                             │
│     └── 等待发送完成                                         │
│                                                              │
│  3. 验证结果                                                │
│     ├── 浮层显示实时转写                                      │
│     ├── 捕获完成后显示发送提示                                │
│     └── 助手收到并响应消息                                    │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 按键通话测试

**测试步骤**：

```
验证按键通话功能：

┌─────────────────────────────────────────────────────────────┐
│  1. 确保配置正确                                             │
│     ├── 按键通话开关：开启                                   │
│     ├── 麦克风权限：已授予                                   │
│     └── 快捷键：右 Option（或 Cmd+Fn）                       │
│                                                              │
│  2. 执行测试                                                 │
│     ├── 按住右 Option 键                                     │
│     ├── 看到浮层显示                                         │
│     ├── 说话（观察实时转写）                                   │
│     ├── 松开按键                                             │
│     ├── 短暂延迟后发送                                       │
│     └── 助手收到并响应                                       │
│                                                              │
│  3. 菜单栏验证                                               │
│     └── 按住时菜单栏耳朵图标应放大                            │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**快捷键说明**：

| 快捷键 | 说明 | 兼容性 |
|--------|------|--------|
| **右 Option** | 默认按键通话键 | macOS 全版本 |
| **Cmd+Fn** | 替代快捷键 | macOS 26+ |

---

## 第七部分：故障排查指南

### 问题分类与诊断流程

```
语音唤醒问题判定树：

├── 唤醒词无法触发
│   ├── 权限问题 → 检查麦克风/语音识别权限
│   ├── 麦克风问题 → 检查设备选择/连接
│   ├── 唤醒词未检测 → 检查环境噪音/发音
│   └── Runtime 未运行 → 检查日志
│
├── 误触发频繁
│   ├── 环境噪音 → 使用按键通话模式
│   ├── 唤醒词太短 → 使用更长的唤醒词
│   └── 敏感度太高 → 调整敏感度设置
│
├── 识别准确率低
│   ├── 麦克风质量问题 → 检查设备/位置
│   ├── 环境噪音 → 寻找安静环境
│   └── 语言设置错误 → 确认语言匹配
│
├── 浮层问题
│   ├── 不显示 → 检查 UI 进程
│   ├── 卡住 → 重启应用
│   └── 无响应 → 检查 VoiceWakeRuntime
│
└── 发送失败
    ├── 网络问题 → 检查连接
    ├── 渠道问题 → 检查渠道状态
    └── 权限问题 → 检查渠道认证
```

### 常见故障与解决方案

**故障一：唤醒词无响应**

**症状**：说出唤醒词后没有任何反应

**诊断**：

```bash
# 检查语音唤醒运行时日志
./scripts/clawlog.sh --category VoiceWake --last 5m

# 检查权限状态
tccutil list | grep -E "Microphone|Speech"
```

**解决方案**：

```
检查清单：

1. 验证权限
   └── 系统设置 → 隐私与安全 → 麦克风/语音识别 → OpenClaw

2. 检查麦克风选择
   └── 设置 → 语音唤醒 → 麦克风 → 选择正确的设备

3. 测试麦克风
   └── 使用系统录音机测试麦克风是否正常

4. 检查日志
   └── ./scripts/clawlog.sh --category VoiceWake --last 5m

5. 重启语音唤醒
   └── 关闭再打开语音唤醒开关
```

**故障二：误触发频繁**

**症状**：日常对话中经常意外触发语音唤醒

**诊断**：

```bash
# 检查误触发日志
./scripts/clawlog.sh --category VoiceWake --last 1h | grep -i "trigger\|wake"
```

**解决方案**：

```
方案一：使用按键通话模式
    设置 → 语音唤醒 → 关闭"语音唤醒"
    设置 → 语音唤醒 → 开启"按住 Cmd+Fn 说话"

方案二：调整敏感度
    设置 → 语音唤醒 → 触发词敏感度 → 低

方案三：更改唤醒词
    使用更不常见的词组

方案四：检查环境
    减少背景噪音
    避免在电视/广播附近使用
```

**故障三：识别准确率低**

**症状**：语音唤醒后，转写的文本与实际说话差异很大

**诊断**：

```bash
# 检查转写日志
./scripts/clawlog.sh --category VoiceWake --last 5m | grep -i "transcript\|recogn"
```

**解决方案**：

```
检查清单：

1. 麦克风位置
    └── 靠近嘴部 15-30 厘米
    └── 避免遮挡

2. 环境噪音
    └── 关闭风扇/空调
    └── 关闭门窗

3. 语言设置
    └── 设置 → 语音唤醒 → 语言 → 选择正确的语言

4. 网络连接（如果使用在线 ASR）
    └── 确保网络稳定
```

**故障四：浮层卡住**

**症状**：语音唤醒后浮层显示但不消失

**解决方案**：

```
即时处理：

1. 点击浮层上的 X 按钮关闭

2. 如果 X 按钮无响应：
   └── 强制退出应用（菜单栏 → Quit）
   └── 重新打开应用

长期处理：
   └── 更新到最新版本（已修复粘滞浮层问题）
```

**故障五：菜单栏图标不放大（按键通话）**

**症状**：按住快捷键时菜单栏耳朵图标没有放大

**诊断**：

```bash
# 检查按键监听日志
./scripts/clawlog.sh --category VoiceWake --last 5m | grep -i "key\|shortcut"
```

**解决方案**：

```
检查清单：

1. 确认快捷键
    └── 右 Option 键
    └── 或 Cmd+Fn（macOS 26+）

2. 检查快捷键冲突
    └── 其他应用可能占用相同快捷键

3. 检查辅助功能权限
    └── 系统设置 → 隐私与安全 → 辅助功能 → OpenClaw
```

**故障六：外部键盘问题**

**症状**：使用外接键盘时按键通话无响应

**原因**：某些外接键盘可能无法正确暴露右 Option 键

**解决方案**：

```
方案一：使用 Cmd+Fn 快捷键
    设置 → 语音唤醒 → 开启"按住 Cmd+Fn 说话"

方案二：检查键盘布局
    └── 系统设置 → 键盘 → 键盘 → 修改快捷键
    └── 验证 Option 键映射

方案三：使用内建键盘
    如果可能，测试内建键盘是否正常工作
```

---

## 适用场景与最佳实践

### 推荐使用场景

**场景一：免提办公**

```
推荐配置：
├── 模式：唤醒词模式
├── 唤醒词：清晰、不常见的词组
├── 敏感度：中等
└── 环境：相对安静的办公室
```

**场景二：嘈杂车间**

```
推荐配置：
├── 模式：按键通话模式
├── 快捷键：Cmd+Fn
└── 麦克风：降噪麦克风
```

**场景三：演示场景**

```
推荐配置：
├── 模式：唤醒词模式
├── 敏感度：较高（便于快速触发）
├── 提示音：清晰的反馈音
└── 提前测试环境声学
```

### 最佳实践

**唤醒词选择**：

```
良好唤醒词特征：
├── 3-4 个音节
├── 不常用词组
├── 发音清晰
└── 与常用词区分度高

良好示例：
├── "Hey Computer"
├── "Hey Assistant"
└── 自定义词组

不良示例：
├── "Hey"（太短，误触发高）
├── "OpenClaw"（长且不常用）
└── "Computer"（太常用）
```

**麦克风优化**：

```
麦克风使用建议：

1. 位置
   ├── 距离嘴部 15-30 厘米
   ├── 避免直接对着麦克风吹气
   └── 保持稳定位置

2. 环境
   ├── 减少回声（关闭门窗）
   ├── 降低背景噪音
   └── 避免风扇/空调直吹

3. 设备
   ├── 使用降噪麦克风
   ├── 优先选择 USB 麦克风
   └── 定期清洁麦克风
```

---

## 章节总结

本章节全面介绍了 OpenClaw macOS 应用的语音唤醒与按键通话功能。通过学习，你应该已经掌握：

1. **交互模式**：理解唤醒词模式与按键通话模式的区别
2. **运行时架构**：深入理解 VoiceWakeRuntime 的组件与状态机
3. **生命周期管理**：掌握生命周期不变量与加固机制
4. **配置选项**：正确配置麦克风、语言与唤醒词
5. **故障排查**：建立系统化的语音问题诊断流程

后续建议结合 [日志系统](/zh-cn/platforms/mac/logging) 与 [权限配置](/zh-cn/platforms/mac/permissions) 章节，完善语音唤醒运维知识体系。

相关文档：[语音唤醒节点](/zh-cn/nodes/voicewake)
